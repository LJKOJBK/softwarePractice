window.__require=function e(t,i,s){function l(o,c){if(!i[o]){if(!t[o]){var a=o.split("/");if(a=a[a.length-1],!t[a]){var u="function"==typeof __require&&__require;if(!c&&u)return u(a,!0);if(n)return n(a,!0);throw new Error("Cannot find module '"+o+"'")}}var r=i[o]={exports:{}};t[o][0].call(r.exports,function(e){return l(t[o][1][e]||e)},r,r.exports,e,t,i,s)}return i[o].exports}for(var n="function"==typeof __require&&__require,o=0;o<s.length;o++)l(s[o]);return l}({AudioUtils:[function(e,t,i){"use strict";cc._RF.push(t,"fe151y+R2lFvas76dyah2Uf","AudioUtils"),cc.Class({extends:cc.Component,properties:{swap:{type:cc.AudioClip,default:null},click:{type:cc.AudioClip,default:null},eliminate:{type:[cc.AudioClip],default:[]},continuousMatch:{type:[cc.AudioClip],default:[]}},onLoad:function(){},start:function(){},playClick:function(){cc.audioEngine.play(this.click,!1,1)},playSwap:function(){cc.audioEngine.play(this.swap,!1,1)},playEliminate:function(e){e=Math.min(this.eliminate.length-1,e),cc.audioEngine.play(this.eliminate[e],!1,1)},playContinuousMatch:function(e){console.log("step = ",e),(e=Math.min(e,11))<2||cc.audioEngine.play(this.continuousMatch[Math.floor(e/2)-1],!1,1)}}),cc._RF.pop()},{}],CellModel:[function(e,t,i){"use strict";cc._RF.push(t,"dae88GCevBMaK7lQqhume8G","CellModel"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),l=e("./ConstValue");function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(){n(this,e),this.type=null,this.status=l.CELL_STATUS.COMMON,this.x=1,this.y=1,this.startX=1,this.startY=1,this.cmd=[],this.isDeath=!1,this.objecCount=Math.floor(1e3*Math.random())}return s(e,[{key:"init",value:function(e){this.type=e}},{key:"isEmpty",value:function(){return this.type==l.CELL_TYPE.EMPTY}},{key:"setEmpty",value:function(){this.type=l.CELL_TYPE.EMPTY}},{key:"setXY",value:function(e,t){this.x=e,this.y=t}},{key:"setStartXY",value:function(e,t){this.startX=e,this.startY=t}},{key:"setStatus",value:function(e){this.status=e}},{key:"moveToAndBack",value:function(e){var t=cc.v2(this.x,this.y);this.cmd.push({action:"moveTo",keepTime:l.ANITIME.TOUCH_MOVE,playTime:0,pos:e}),this.cmd.push({action:"moveTo",keepTime:l.ANITIME.TOUCH_MOVE,playTime:l.ANITIME.TOUCH_MOVE,pos:t})}},{key:"moveTo",value:function(e,t){this.cmd.push({action:"moveTo",keepTime:l.ANITIME.TOUCH_MOVE,playTime:t,pos:e}),this.x=e.x,this.y=e.y}},{key:"toDie",value:function(e){this.cmd.push({action:"toDie",playTime:e,keepTime:l.ANITIME.DIE}),this.isDeath=!0}},{key:"toShake",value:function(e){this.cmd.push({action:"toShake",playTime:e,keepTime:l.ANITIME.DIE_SHAKE})}},{key:"setVisible",value:function(e,t){this.cmd.push({action:"setVisible",playTime:e,keepTime:0,isVisible:t})}},{key:"moveToAndDie",value:function(e){}},{key:"isBird",value:function(){return this.type==l.CELL_TYPE.G}}]),e}();i.default=o,t.exports=i.default,cc._RF.pop()},{"./ConstValue":"ConstValue"}],CellView:[function(e,t,i){"use strict";cc._RF.push(t,"fbf19Cx4ptFV62UZ7+qJJpQ","CellView");var s=e("../Model/ConstValue");cc.Class({extends:cc.Component,properties:{defaultFrame:{default:null,type:cc.SpriteFrame}},onLoad:function(){this.isSelect=!1},initWithModel:function(e){this.model=e;var t=e.startX,i=e.startY;this.node.x=s.CELL_WIDTH*(t-.5),this.node.y=s.CELL_HEIGHT*(i-.5);var l=this.node.getComponent(cc.Animation);e.status==s.CELL_STATUS.COMMON?l.stop():l.play(e.status)},updateView:function(){var e=this,t=this.model.cmd;if(!(t.length<=0)){var i,l=[],n=0;for(var o in t){if(t[o].playTime>n){var c=cc.delayTime(t[o].playTime-n);l.push(c)}if("moveTo"==t[o].action){var a=(t[o].pos.x-.5)*s.CELL_WIDTH,u=(t[o].pos.y-.5)*s.CELL_HEIGHT,r=cc.moveTo(s.ANITIME.TOUCH_MOVE,cc.v2(a,u));l.push(r)}else if("toDie"==t[o].action){if(this.status==s.CELL_STATUS.BIRD)this.node.getComponent(cc.Animation).play("effect"),l.push(cc.delayTime(s.ANITIME.BOMB_BIRD_DELAY));var h=cc.callFunc(function(){this.node.destroy()},this);l.push(h)}else if("setVisible"==t[o].action)(function(){var i=t[o].isVisible;l.push(cc.callFunc(function(){this.node.opacity=i?255:0},e))})();else if("toShake"==t[o].action){var f=cc.rotateBy(.06,30),p=cc.rotateBy(.12,-60);l.push(cc.repeat(cc.sequence(f,p,f),2))}n=t[o].playTime+t[o].keepTime}if(1==l.length)this.node.runAction(l[0]);else this.node.runAction((i=cc).sequence.apply(i,l))}},setSelect:function(e){var t=this.node.getComponent(cc.Animation),i=this.node.getChildByName("select");0==e&&this.isSelect&&this.model.status==s.CELL_STATUS.COMMON?(t.stop(),this.node.getComponent(cc.Sprite).spriteFrame=this.defaultFrame):e&&this.model.status==s.CELL_STATUS.COMMON?t.play(s.CELL_STATUS.CLICK):e&&this.model.status==s.CELL_STATUS.BIRD&&t.play(s.CELL_STATUS.CLICK),i.active=e,this.isSelect=e}}),cc._RF.pop()},{"../Model/ConstValue":"ConstValue"}],ConstValue:[function(e,t,i){"use strict";cc._RF.push(t,"f9088esGbNBtJmNaJsz0Gq4","ConstValue"),Object.defineProperty(i,"__esModule",{value:!0});i.CELL_TYPE={EMPTY:0,A:1,B:2,C:3,D:4,E:5,F:6,BIRD:7},i.CELL_BASENUM=6,i.CELL_STATUS={COMMON:0,CLICK:"click",LINE:"line",COLUMN:"column",WRAP:"wrap",BIRD:"bird"};var s=i.GRID_WIDTH=9,l=i.GRID_HEIGHT=9,n=i.CELL_WIDTH=70,o=i.CELL_HEIGHT=70;i.GRID_PIXEL_WIDTH=s*n,i.GRID_PIXEL_HEIGHT=l*o,i.ANITIME={TOUCH_MOVE:.3,DIE:.2,DOWN:.5,BOMB_DELAY:.3,BOMB_BIRD_DELAY:.7,DIE_SHAKE:.4};cc._RF.pop()},{}],EffectLayer:[function(e,t,i){"use strict";cc._RF.push(t,"0e925myn0dIjqdao1TpipF9","EffectLayer");var s=e("../Model/ConstValue"),l=function(e){return e&&e.__esModule?e:{default:e}}(e("../Utils/AudioUtils"));cc.Class({extends:cc.Component,properties:{bombWhite:{default:null,type:cc.Prefab},crushEffect:{default:null,type:cc.Prefab},audioUtils:{type:l.default,default:null}},onLoad:function(){},playEffects:function(e){if(e&&!(e.length<=0)){var t={};e.forEach(function(e){var i=cc.delayTime(e.playTime),l=cc.callFunc(function(){var i=null,l=null;"crush"==e.action?((l=(i=cc.instantiate(this.crushEffect)).getComponent(cc.Animation)).play("effect"),!t["crush"+e.playTime]&&this.audioUtils.playEliminate(e.step),t["crush"+e.playTime]=!0):"rowBomb"==e.action?(l=(i=cc.instantiate(this.bombWhite)).getComponent(cc.Animation)).play("effect_line"):"colBomb"==e.action&&(l=(i=cc.instantiate(this.bombWhite)).getComponent(cc.Animation)).play("effect_col"),i.x=s.CELL_WIDTH*(e.pos.x-.5),i.y=s.CELL_WIDTH*(e.pos.y-.5),i.parent=this.node,l.on("finished",function(){i.destroy()},this)},this);this.node.runAction(cc.sequence(i,l))},this)}}}),cc._RF.pop()},{"../Model/ConstValue":"ConstValue","../Utils/AudioUtils":"AudioUtils"}],GameController:[function(e,t,i){"use strict";cc._RF.push(t,"5ac64Iq16lBqrHZ0246FRcZ","GameController");var s=function(e){return e&&e.__esModule?e:{default:e}}(e("../Model/GameModel"));var l=e("../Global.js");cc.Class({extends:cc.Component,properties:{grid:{default:null,type:cc.Node},timeLabel:{default:null,type:cc.Label},mask:{default:null,type:cc.Node}},onLoad:function(){this.gameover=!1,this.handleTimingModel(),this.gameModel=new s.default,this.gameModel.init(4);var e=this.grid.getComponent("GridView");e.setController(this),e.initWithCellModels(this.gameModel.getCells())},selectCell:function(e){return this.gameModel.selectCell(e)},cleanCmd:function(){this.gameModel.cleanCmd()},handleTimingModel:function(){this.isTimingModel=1==l.type,this.isTimingModel&&(this.timeLast=60,this.timeLabel.node.active=!0)},update:function(e){this.isTimingModel&&!this.gameover&&(this.timeLast-=e,this.timeLabel.string=Math.ceil(this.timeLast),this.timeLast<=0&&(this.gameover=!0,this.mask.active=!0))}}),cc._RF.pop()},{"../Global.js":"Global","../Model/GameModel":"GameModel"}],GameModelTest:[function(e,t,i){"use strict";cc._RF.push(t,"16fce9lOkpA7a2vuhmMkDMZ","GameModelTest"),cc.Class({extends:cc.Component,properties:{}}),cc._RF.pop()},{}],GameModel:[function(e,t,i){"use strict";cc._RF.push(t,"cc442HaMlBE/ZKi7W/YUKwd","GameModel"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var s=function(){function e(e,t){var i=[],s=!0,l=!1,n=void 0;try{for(var o,c=e[Symbol.iterator]();!(s=(o=c.next()).done)&&(i.push(o.value),!t||i.length!==t);s=!0);}catch(e){l=!0,n=e}finally{try{!s&&c.return&&c.return()}finally{if(l)throw n}}return i}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,i,s){return i&&e(t.prototype,i),s&&e(t,s),t}}(),n=function(e){return e&&e.__esModule?e:{default:e}}(e("./CellModel")),o=e("./ConstValue");function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(){c(this,e),this.cells=null,this.cellBgs=null,this.lastPos=cc.v2(-1,-1),this.cellTypeNum=5,this.cellCreateType=[]}return l(e,[{key:"init",value:function(e){this.cells=[],this.setCellTypeNum(e||this.cellTypeNum);for(var t=1;t<=o.GRID_WIDTH;t++){this.cells[t]=[];for(var i=1;i<=o.GRID_HEIGHT;i++)this.cells[t][i]=new n.default}for(var s=1;s<=o.GRID_WIDTH;s++)for(var l=1;l<=o.GRID_HEIGHT;l++){var c=[];do{this.cells[s][l].init(this.getRandomCellType()),c=this.checkPoint(l,s)[0]}while(c.length>2);this.cells[s][l].setXY(l,s),this.cells[s][l].setStartXY(l,s)}}},{key:"initWithData",value:function(e){}},{key:"checkPoint",value:function(e,t){var i=function(e,t,i){var s=[],l=[];l[e+9*t]=!0,s.push(cc.v2(e,t));for(var n=0;n<s.length;){var o=s[n],c=this.cells[o.y][o.x];if(n++,c)for(var a=0;a<i.length;a++){var u=o.x+i[a].x,r=o.y+i[a].y;u<1||u>9||r<1||r>9||l[u+9*r]||!this.cells[r][u]||c.type==this.cells[r][u].type&&(l[u+9*r]=!0,s.push(cc.v2(u,r)))}}return s},s=i.call(this,e,t,[cc.v2(1,0),cc.v2(-1,0)]),l=i.call(this,e,t,[cc.v2(0,-1),cc.v2(0,1)]),n=[],c="";if(s.length>=5||l.length>=5?c=o.CELL_STATUS.BIRD:s.length>=3&&l.length>=3?c=o.CELL_STATUS.WRAP:s.length>=4?c=o.CELL_STATUS.LINE:l.length>=4&&(c=o.CELL_STATUS.COLUMN),s.length>=3&&(n=s),l.length>=3){var a=n.concat();l.forEach(function(e){var t=!1;a.forEach(function(i){e.x==i.x&&e.y==i.y&&(t=!0)},this),t||n.push(e)},this)}return[n,c,this.cells[t][e].type]}},{key:"printInfo",value:function(){for(var e=1;e<=9;e++){for(var t="",i=1;i<=9;i++)t+=this.cells[e][i].type+" ";console.log(t)}}},{key:"getCells",value:function(){return this.cells}},{key:"selectCell",value:function(e){this.changeModels=[],this.effectsQueue=[];var t=this.lastPos;if(1!=Math.abs(e.x-t.x)+Math.abs(e.y-t.y))return this.lastPos=e,[[],[]];var i=this.cells[e.y][e.x],s=this.cells[t.y][t.x];this.exchangeCell(t,e);var l=this.checkPoint(e.x,e.y)[0],n=this.checkPoint(t.x,t.y)[0];this.curTime=0,this.pushToChangeModels(i),this.pushToChangeModels(s);var c=i.status!=o.CELL_STATUS.COMMON&&s.status!=o.CELL_STATUS.COMMON||i.status==o.CELL_STATUS.BIRD||s.status==o.CELL_STATUS.BIRD;if(l.length<3&&n.length<3&&!c)return this.exchangeCell(t,e),i.moveToAndBack(t),s.moveToAndBack(e),this.lastPos=cc.v2(-1,-1),[this.changeModels];this.lastPos=cc.v2(-1,-1),i.moveTo(t,this.curTime),s.moveTo(e,this.curTime);var a=[e,t];return this.curTime+=o.ANITIME.TOUCH_MOVE,this.processCrush(a),[this.changeModels,this.effectsQueue]}},{key:"processCrush",value:function(e){for(var t=0;e.length>0;){var i=[];if(0==t&&2==e.length){var l=e[0],n=e[1],c=this.cells[l.y][l.x],a=this.cells[n.y][n.x];c.status!=o.CELL_STATUS.BIRD&&a.status!=o.CELL_STATUS.BIRD||(c.status==o.CELL_STATUS.BIRD?(c.type=a.type,i.push(c)):(a.type=c.type,i.push(a)))}for(var u in e){var r=e[u];if(this.cells[r.y][r.x]){var h=this.checkPoint(r.x,r.y),f=s(h,3),p=f[0],d=f[1],T=f[2];if(!(p.length<3)){for(var y in p){var C=this.cells[p[y].y][p[y].x];this.crushCell(p[y].x,p[y].y,!1,t),C.status!=o.CELL_STATUS.COMMON&&i.push(C)}this.createNewCell(r,d,T)}}}this.processBomb(i,t),this.curTime+=o.ANITIME.DIE,e=this.down(),t++}}},{key:"createNewCell",value:function(e,t,i){if(""!=t){t==o.CELL_STATUS.BIRD&&(i=o.CELL_TYPE.BIRD);var s=new n.default;this.cells[e.y][e.x]=s,s.init(i),s.setStartXY(e.x,e.y),s.setXY(e.x,e.y),s.setStatus(t),s.setVisible(0,!1),s.setVisible(this.curTime,!0),this.changeModels.push(s)}}},{key:"down",value:function(){for(var e=[],t=1;t<=o.GRID_WIDTH;t++)for(var i=1;i<=o.GRID_HEIGHT;i++)if(null==this.cells[t][i]){for(var s=t,l=s;l<=o.GRID_HEIGHT;l++)this.cells[l][i]&&(this.pushToChangeModels(this.cells[l][i]),e.push(this.cells[l][i]),this.cells[s][i]=this.cells[l][i],this.cells[l][i]=null,this.cells[s][i].setXY(i,s),this.cells[s][i].moveTo(cc.v2(i,s),this.curTime),s++);for(var c=1,a=s;a<=o.GRID_HEIGHT;a++)this.cells[a][i]=new n.default,this.cells[a][i].init(this.getRandomCellType()),this.cells[a][i].setStartXY(i,c+o.GRID_HEIGHT),this.cells[a][i].setXY(i,c+o.GRID_HEIGHT),this.cells[a][i].moveTo(cc.v2(i,a),this.curTime),c++,this.changeModels.push(this.cells[a][i]),e.push(this.cells[a][i])}return this.curTime+=o.ANITIME.TOUCH_MOVE+.3,e}},{key:"pushToChangeModels",value:function(e){-1==this.changeModels.indexOf(e)&&this.changeModels.push(e)}},{key:"cleanCmd",value:function(){for(var e=1;e<=o.GRID_WIDTH;e++)for(var t=1;t<=o.GRID_HEIGHT;t++)this.cells[e][t]&&(this.cells[e][t].cmd=[])}},{key:"exchangeCell",value:function(e,t){var i=[this.cells[t.y][t.x],this.cells[e.y][e.x]];this.cells[e.y][e.x]=i[0],this.cells[t.y][t.x]=i[1]}},{key:"setCellTypeNum",value:function(e){console.log("num = ",e),this.cellTypeNum=e,this.cellCreateType=[];for(var t=this.cellCreateType,i=1;i<=o.CELL_BASENUM;i++)t.push(i);for(var s=0;s<t.length;s++){var l=Math.floor(Math.random()*(o.CELL_BASENUM-s))+s;t[s],t[l]=t[l],t[s]}}},{key:"getRandomCellType",value:function(){var e=Math.floor(Math.random()*this.cellTypeNum);return this.cellCreateType[e]}},{key:"processBomb",value:function(e,t){for(var i=this,s=function(){var s=[],l=o.ANITIME.BOMB_DELAY;e.forEach(function(e){switch(e.status){case o.CELL_STATUS.LINE:for(var i=1;i<=o.GRID_WIDTH;i++)this.cells[e.y][i]&&(this.cells[e.y][i].status!=o.CELL_STATUS.COMMON&&s.push(this.cells[e.y][i]),this.crushCell(i,e.y,!1,t));this.addRowBomb(this.curTime,cc.v2(e.x,e.y));break;case o.CELL_STATUS.COLUMN:for(var n=1;n<=o.GRID_HEIGHT;n++)this.cells[n][e.x]&&(this.cells[n][e.x].status!=o.CELL_STATUS.COMMON&&s.push(this.cells[n][e.x]),this.crushCell(e.x,n,!1,t));this.addColBomb(this.curTime,cc.v2(e.x,e.y));break;case o.CELL_STATUS.WRAP:for(var c=e.x,a=e.y,u=1;u<=o.GRID_HEIGHT;u++)for(var r=1;r<=o.GRID_WIDTH;r++){var h=Math.abs(c-r)+Math.abs(a-u);this.cells[u][r]&&h<=2&&(this.cells[u][r].status!=o.CELL_STATUS.COMMON&&s.push(this.cells[u][r]),this.crushCell(r,u,!1,t))}break;case o.CELL_STATUS.BIRD:var f=e.type;l<o.ANITIME.BOMB_BIRD_DELAY&&(l=o.ANITIME.BOMB_BIRD_DELAY),f==o.CELL_TYPE.BIRD&&(f=this.getRandomCellType());for(var p=1;p<=o.GRID_HEIGHT;p++)for(var d=1;d<=o.GRID_WIDTH;d++)this.cells[p][d]&&this.cells[p][d].type==f&&(this.cells[p][d].status!=o.CELL_STATUS.COMMON&&s.push(this.cells[p][d]),this.crushCell(d,p,!0,t))}},i),e.length>0&&(i.curTime+=l),e=s};e.length>0;)s()}},{key:"addCrushEffect",value:function(e,t,i){this.effectsQueue.push({playTime:e,pos:t,action:"crush",step:i})}},{key:"addRowBomb",value:function(e,t){this.effectsQueue.push({playTime:e,pos:t,action:"rowBomb"})}},{key:"addColBomb",value:function(e,t){this.effectsQueue.push({playTime:e,pos:t,action:"colBomb"})}},{key:"addWrapBomb",value:function(e,t){}},{key:"crushCell",value:function(e,t,i,s){var l=this.cells[t][e];this.pushToChangeModels(l),i&&l.toShake(this.curTime);var n=i?o.ANITIME.DIE_SHAKE:0;l.toDie(this.curTime+n),this.addCrushEffect(this.curTime+n,cc.v2(l.x,l.y),s),this.cells[t][e]=null}}]),e}();i.default=a,t.exports=i.default,cc._RF.pop()},{"./CellModel":"CellModel","./ConstValue":"ConstValue"}],Global:[function(e,t,i){"use strict";cc._RF.push(t,"b24806mUnZARas8kqiOM5BB","Global"),t.exports={type:0},cc._RF.pop()},{}],GridView:[function(e,t,i){"use strict";cc._RF.push(t,"d0d1fDj9rlDx5QUtP+2toQV","GridView");var s=e("../Model/ConstValue"),l=function(e){return e&&e.__esModule?e:{default:e}}(e("../Utils/AudioUtils"));cc.Class({extends:cc.Component,properties:{aniPre:{default:[],type:[cc.Prefab]},effectLayer:{default:null,type:cc.Node},audioUtils:{type:l.default,default:null}},onLoad:function(){this.setListener(),this.lastTouchPos=cc.Vec2(-1,-1),this.isCanMove=!0,this.isInPlayAni=!1},setController:function(e){this.controller=e},initWithCellModels:function(e){this.cellViews=[];for(var t=1;t<=9;t++){this.cellViews[t]=[];for(var i=1;i<=9;i++){var s=e[t][i].type,l=cc.instantiate(this.aniPre[s]);l.parent=this.node,l.getComponent("CellView").initWithModel(e[t][i]),this.cellViews[t][i]=l}}},setListener:function(){this.node.on(cc.Node.EventType.TOUCH_START,function(e){if(this.isInPlayAni)return!0;var t=this.convertTouchPosToCell(e.getLocation());return t&&this.selectCell(t),this.isCanMove=!!t,!0},this),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){if(this.isCanMove){var t=this.convertTouchPosToCell(e.getStartLocation()),i=this.convertTouchPosToCell(e.getLocation());t.x==i.x&&t.y==i.y||(this.isCanMove=!1,this.selectCell(i))}},this)},convertTouchPosToCell:function(e){if((e=this.node.convertToNodeSpace(e)).x<0||e.x>=s.GRID_PIXEL_WIDTH||e.y<0||e.y>=s.GRID_PIXEL_HEIGHT)return!1;var t=Math.floor(e.x/s.CELL_WIDTH)+1,i=Math.floor(e.y/s.CELL_HEIGHT)+1;return cc.v2(t,i)},updateView:function(e){var t=[];for(var i in e){var s=e[i],l=this.findViewByModel(s),n=null;if(l)n=l.view,this.cellViews[l.y][l.x]=null;else{var o=s.type,c=cc.instantiate(this.aniPre[o]);c.parent=this.node,c.getComponent("CellView").initWithModel(s),n=c}n.getComponent("CellView").updateView(),s.isDeath||t.push({model:s,view:n})}t.forEach(function(e){var t=e.model;this.cellViews[t.y][t.x]=e.view},this)},updateSelect:function(e){for(var t=1;t<=9;t++)for(var i=1;i<=9;i++)if(this.cellViews[t][i]){var s=this.cellViews[t][i].getComponent("CellView");e.x==i&&e.y==t?s.setSelect(!0):s.setSelect(!1)}},findViewByModel:function(e){for(var t=1;t<=9;t++)for(var i=1;i<=9;i++)if(this.cellViews[t][i]&&this.cellViews[t][i].getComponent("CellView").model==e)return{view:this.cellViews[t][i],x:i,y:t};return null},getPlayAniTime:function(e){if(!e)return 0;var t=0;return e.forEach(function(e){e.cmd.forEach(function(e){t<e.playTime+e.keepTime&&(t=e.playTime+e.keepTime)},this)},this),t},getStep:function(e){return e?e.reduce(function(e,t){return Math.max(e,t.step||0)},0):0},disableTouch:function(e,t){e<=0||(this.isInPlayAni=!0,this.node.runAction(cc.sequence(cc.delayTime(e),cc.callFunc(function(){this.isInPlayAni=!1,this.audioUtils.playContinuousMatch(t)},this))))},selectCell:function(e){var t=this.controller.selectCell(e),i=t[0],s=t[1];return this.playEffect(s),this.disableTouch(this.getPlayAniTime(i),this.getStep(s)),this.updateView(i),this.controller.cleanCmd(),i.length>=2?(this.updateSelect(cc.v2(-1,-1)),this.audioUtils.playSwap()):(this.updateSelect(e),this.audioUtils.playClick()),i},playEffect:function(e){this.effectLayer.getComponent("EffectLayer").playEffects(e)}}),cc._RF.pop()},{"../Model/ConstValue":"ConstValue","../Utils/AudioUtils":"AudioUtils"}],LoginController:[function(e,t,i){"use strict";cc._RF.push(t,"5f4845Bus5AQoZakK7KAXht","LoginController");(function(e){e&&e.__esModule})(e("../Utils/AudioUtils"));var s=e("../Global.js");cc.Class({extends:cc.Component,properties:{loadingBar:{type:cc.ProgressBar,default:null},loginBtn1:{type:cc.Button,default:null},loginBtn2:{type:cc.Button,default:null},worldSceneBGM:{type:cc.AudioClip,default:null}},onLoad:function(){this.gameSceneBGMAudioId=cc.audioEngine.play(this.worldSceneBGM,!0,1)},start:function(){},onLogin:function(e,t){this.loadingBar.node.active=!0,this.loginBtn1.node.active=this.loginBtn2.node.active=!1,s.type=t,this.loadingBar.progress=0;var i=cc.loader.onProgress;cc.loader.onProgress=function(e,t){this.loadingBar.progress=e/t}.bind(this),cc.director.preloadScene("Game",function(){cc.loader.onProgress=i,this.loadingBar.node.active=!1,this.loginBtn1.node.active=this.loginBtn2.node.active=!0,cc.director.loadScene("Game")}.bind(this))},onDestroy:function(){cc.audioEngine.stop(this.gameSceneBGMAudioId)}}),cc._RF.pop()},{"../Global.js":"Global","../Utils/AudioUtils":"AudioUtils"}]},{},["GameController","LoginController","Global","CellModel","ConstValue","GameModel","GameModelTest","AudioUtils","CellView","EffectLayer","GridView"]);